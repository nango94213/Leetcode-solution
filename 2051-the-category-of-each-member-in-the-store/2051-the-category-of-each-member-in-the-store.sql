# Write your MySQL query statement below

select a.member_id, a.name, case when 100*count(charged_amount)/count(visit_date ) >= 80 then "Diamond" when 100*count(charged_amount)/count(visit_date ) >= 50 then "Gold" when 100*count(charged_amount)/count(visit_date ) < 50 then "Silver" else "Bronze" end category from Members a left join Visits b on a.member_id = b.member_id left join Purchases c on b.visit_id = c.visit_id group by a.member_id